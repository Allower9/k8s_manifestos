##### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ALB Ingress-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä

–î–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ –º–µ–∂–¥—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ Kubernetes –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Ingress-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä Yandex Application Load Balancer. –û–Ω –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç —Ä–µ—Å—É—Ä—Å Ingress –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ Managed Service for Kubernetes.

##### 1Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è —Ä–∞–±–æ—Ç—ã Ingress-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞.

##### 2Ô∏è‚É£ –ù–∞–∑–Ω–∞—á—å—Ç–µ –µ–º—É —Ä–æ–ª–∏:
- `alb.editor` ‚Äî –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤.
- `vpc.publicAdmin` ‚Äî –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–Ω–µ—à–Ω–µ–π —Å–≤—è–∑–Ω–æ—Å—Ç—å—é.
- `certificate-manager.certificates.downloader` ‚Äî –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –≤ —Å–µ—Ä–≤–∏—Å–µ Yandex Certificate Manager.
- `compute.viewer` ‚Äî –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É–∑–ª–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–∞ Managed Service for Kubernetes –≤ —Ü–µ–ª–µ–≤—ã—Ö –≥—Ä—É–ø–ø–∞—Ö –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞.

##### 3Ô∏è‚É£ –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ ALB Ingress Controller –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É Marketplace:
![Marketplace](https://github.com/user-attachments/assets/06c942e9-7e1e-4ae4-bf48-9cc0f4d186ea)

##### 4Ô∏è‚É£ –ù–∞–π–¥–∏—Ç–µ –≤ –ø–æ–∏—Å–∫–µ ALB Ingress Controller –∏ –∑–∞–π–¥–∏—Ç–µ –≤ —ç—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
![ALB Ingress Controller](https://github.com/user-attachments/assets/56538a55-ce64-45ad-a4f6-0713430b720b)

##### 5Ô∏è‚É£ –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ü–µ—Ä–µ–π—Ç–∏ –∫ —É—Å—Ç–∞–Ω–æ–≤–∫–µ":
![–£—Å—Ç–∞–Ω–æ–≤–∫–∞](https://github.com/user-attachments/assets/fb0e06f2-4137-4aa1-a5c0-1977a364b7c3)

##### 6Ô∏è‚É£ –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
![–ü–∞—Ä–∞–º–µ—Ç—Ä—ã](https://github.com/user-attachments/assets/91715986-8b68-4306-8113-6c3a7a1675c1)

##### 7Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º—ë–Ω –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ –Ω–µ–≥–æ ALB Ingress Controller, –Ω–∞–ø—Ä–∏–º–µ—Ä `alb-ingress`.

##### 8Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–ª—é—á –¥–ª—è —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞, —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –≤ –ø—É–Ω–∫—Ç–µ 1.

##### 9Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
![–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](https://github.com/user-attachments/assets/94aa8e5c-9e57-4bf4-b107-076e0451457e)

##### üîü –ß–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è (–æ–±—ã—á–Ω–æ –º–µ–Ω–µ–µ –º–∏–Ω—É—Ç—ã) –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∏ –∏–∑–º–µ–Ω–∏—Ç —Å—Ç–∞—Ç—É—Å —Å `Pending install` –Ω–∞ `Deployed`.

---

##### –ë—Ä–∏–≥–∞–¥–∏—Ä
–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å Ingress –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ, –∏ Ingress Controller —Å–æ–∑–¥–∞—Å—Ç –¥–ª—è –Ω–µ–≥–æ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã –≤ –æ–±–ª–∞–∫–µ.

##### –°–æ–∑–¥–∞–π—Ç–µ Ingress
Ingress –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –≤–Ω–µ—à–Ω–∏–º –¥–æ—Å—Ç—É–ø–æ–º –∫ —Å–µ—Ä–≤–∏—Å–∞–º –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ Kubernetes, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≥–∏–±–∫–æ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ HTTP- –∏ HTTPS-—Ç—Ä–∞—Ñ–∏–∫–∞. –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –≤—ã —Å–æ–∑–¥–∞–¥–∏—Ç–µ –ø—Ä–æ—Å—Ç–æ–π Ingress –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ HTTP-—Ç—Ä–∞—Ñ–∏–∫–∞.

##### 1Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –æ–±—ä–µ–∫—Ç Ingress:
```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: nginx-ingress
  namespace: nginx-with-svc
  annotations:
    ingress.alb.yc.io/subnets: <subnet_ids>
    ingress.alb.yc.io/external-ipv4-address: auto
    ingress.alb.yc.io/group-name: my-ingress-group
spec:
  rules:
    - host: my-nginx-ingress.yc-course.ru
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: nginx-service
                port:
                  number: 80
```
##### –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

**–ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (metadata.annotations):**

- `ingress.alb.yc.io/subnets`:
  - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–¥—Å–µ—Ç–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è ALB
  - –ü–æ–ª—É—á–∏—Ç—å ID –ø–æ–¥—Å–µ—Ç–∏ –º–æ–∂–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π:
    ```bash
    yc managed-kubernetes cluster list-node-groups \
        --name <cluster_name> \
        --format json | jq '.[].node_template.network_interface_specs[].subnet_ids[]'
    ```
    *(–¢—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ `jq`)*

- `ingress.alb.yc.io/external-ipv4-address`:
  - –ó–Ω–∞—á–µ–Ω–∏–µ `auto` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ IPv4-–∞–¥—Ä–µ—Å–∞
  - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π IP

- `ingress.alb.yc.io/group-name`:
  - –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∏–º—è –≥—Ä—É–ø–ø—ã Ingress (–Ω–∞–ø—Ä–∏–º–µ—Ä `my-ingress-group`)
  - –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ Ingress-—Ä–µ—Å—É—Ä—Å—ã

**–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (spec):**

- `rules` - –ø—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏:
  - `host`: –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ (–≤ –ø—Ä–∏–º–µ—Ä–µ `my-nginx-ingress.yc-course.ru`)
  - `http.paths`: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—É—Ç–µ–π:
    - `path`: URL-–ø—É—Ç—å (`/` - –∫–æ—Ä–Ω–µ–≤–æ–π)
    - `pathType`: –¢–∏–ø —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è (`Prefix` –∏–ª–∏ `Exact`)
    - `backend`: –ö—É–¥–∞ –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å —Ç—Ä–∞—Ñ–∏–∫:
      - `service.name`: –ò–º—è —Å–µ—Ä–≤–∏—Å–∞ (`nginx-service`)
      - `service.port.number`: –ü–æ—Ä—Ç —Å–µ—Ä–≤–∏—Å–∞ (`80`)

**–í–∞–∂–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è:**
1. –í—Å–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã ALB –≤ Yandex Cloud
2. –î–ª—è HTTPS –Ω—É–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:
   - –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤ Certificate Manager
   - –ê–Ω–Ω–æ—Ç–∞—Ü–∏—é `ingress.alb.yc.io/security-groups`
3. –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è:
   - –ü—É–±–ª–∏—á–Ω—ã–π IP (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –ø—Ä–∏ `auto`)
   - –ü—Ä–∞–≤–∏–ª–∞ firewall –≤ –æ–±–ª–∞—á–Ω–æ–π —Å–µ—Ç–∏

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Ingress-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å–æ–∑–¥–∞–Ω. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ –ø–æ–ª–µ ADDRESS –≤ –≤—ã–≤–æ–¥–µ –∫–æ–º–∞–Ω–¥—ã –ø–æ—è–≤–∏–ª–æ—Å—å –∑–Ω–∞—á–µ–Ω–∏–µ:

##### kubectl -n nginx-with-svc get ingress 

##### $ kubectl -n nginx-with-svc get ingress
##### NAME            CLASS    HOSTS                           ADDRESS           PORTS   AGE
##### nginx-ingress   <none>   my-nginx-ingress.yc-course.ru   158.160.176.243   80      12m 
##### 3Ô∏è‚É£ –í —Ä–∞–º–∫–∞—Ö –¥–∞–Ω–Ω–æ–≥–æ —É—Ä–æ–∫–∞ –º—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω–æ–µ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è, –¥–æ–±–∞–≤—å—Ç–µ –≤ HOSTS-—Ñ–∞–π–ª –∑–∞–ø–∏—Å—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ Ingress:
##### 158.160.176.243 my-nginx-ingress.yc-course.ru 
##### 4Ô∏è‚É£ –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É http://my-nginx-ingress.yc-course.ru/. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:
##### Welcome to Nginx!
##### If you see this page, the Nginx web server is successfully configured and basic auth is in use.

##### Learn more about deploying and managing applications with Kubernetes in our comprehensive Kubernetes course.

##### Pod IP: nginx-deployment-59bdf598c7-9ltxc 
#####–ï—Å–ª–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É, –Ω–∞–∑–≤–∞–Ω–∏–µ Pod –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å—Å—è, —Ç–∞–∫ –∫–∞–∫ —Å–µ—Ä–≤–∏—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –≤ —Ä–∞–∑–Ω—ã–µ Pods.
##### –í—ã —Å–æ–∑–¥–∞–ª–∏ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π Ingress –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞ –∫ –≤–∞—à–µ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é. –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π Ingress –≤—ã –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ—Å—å –≤ —Å–ª–µ–¥—É—é—â–µ–π —Ç–µ–º–µ.
